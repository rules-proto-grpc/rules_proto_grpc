---
bazel: d73358090bd4565477114a07f8f0b7bb75e473cc  #Â 8.4.0 branch
tasks:
  main_ubuntu2204:
    name: Build & Test All
    platform: ubuntu2204
    test_flags:
      - "--test_output=errors"
      - "--cxxopt=-std=c++17"
      - "--host_cxxopt=-std=c++17"
    test_targets:
      - "//examples/routeguide:cpp_cpp"
      - "//examples/routeguide:cpp_csharp"
      - "//examples/routeguide:cpp_go"
      - "//examples/routeguide:cpp_java"
      - "//examples/routeguide:cpp_js"
      - "//examples/routeguide:cpp_python"
      - "//examples/routeguide:csharp_cpp"
      - "//examples/routeguide:csharp_csharp"
      - "//examples/routeguide:csharp_go"
      - "//examples/routeguide:csharp_java"
      - "//examples/routeguide:csharp_js"
      - "//examples/routeguide:csharp_python"
      - "//examples/routeguide:go_cpp"
      - "//examples/routeguide:go_csharp"
      - "//examples/routeguide:go_go"
      - "//examples/routeguide:go_java"
      - "//examples/routeguide:go_js"
      - "//examples/routeguide:go_python"
      - "//examples/routeguide:java_cpp"
      - "//examples/routeguide:java_csharp"
      - "//examples/routeguide:java_go"
      - "//examples/routeguide:java_java"
      - "//examples/routeguide:java_js"
      - "//examples/routeguide:java_python"
      - "//examples/routeguide:js_cpp"
      - "//examples/routeguide:js_csharp"
      - "//examples/routeguide:js_go"
      - "//examples/routeguide:js_java"
      - "//examples/routeguide:js_js"
      - "//examples/routeguide:js_python"
      - "//examples/routeguide:python_cpp"
      - "//examples/routeguide:python_csharp"
      - "//examples/routeguide:python_go"
      - "//examples/routeguide:python_java"
      - "//examples/routeguide:python_js"
      - "//examples/routeguide:python_python"
      - "//examples/routeguide:scala_cpp"
      - "//examples/routeguide:scala_csharp"
      - "//examples/routeguide:scala_go"
      - "//examples/routeguide:scala_java"
      - "//examples/routeguide:scala_js"
      - "//examples/routeguide:scala_python"

  main_windows:
    name: Build & Test All
    platform: windows
    test_flags:
      - "--test_output=errors"
      - "--enable_runfiles"
      - "--cxxopt=/std:c++17"
      - "--host_cxxopt=/std:c++17"
      - "--define=protobuf_allow_msvc=true"
    test_targets:
      - "//examples/routeguide:cpp_cpp"
      - "//examples/routeguide:cpp_csharp"
      - "//examples/routeguide:cpp_go"
      - "//examples/routeguide:cpp_java"
      - "//examples/routeguide:cpp_js"
      - "//examples/routeguide:cpp_python"
      - "//examples/routeguide:csharp_cpp"
      - "//examples/routeguide:csharp_csharp"
      - "//examples/routeguide:csharp_go"
      - "//examples/routeguide:csharp_java"
      - "//examples/routeguide:csharp_js"
      - "//examples/routeguide:csharp_python"
      - "//examples/routeguide:go_cpp"
      - "//examples/routeguide:go_csharp"
      - "//examples/routeguide:go_go"
      - "//examples/routeguide:go_java"
      - "//examples/routeguide:go_js"
      - "//examples/routeguide:go_python"
      - "//examples/routeguide:java_cpp"
      - "//examples/routeguide:java_csharp"
      - "//examples/routeguide:java_go"
      - "//examples/routeguide:java_java"
      - "//examples/routeguide:java_js"
      - "//examples/routeguide:java_python"
      - "//examples/routeguide:js_cpp"
      - "//examples/routeguide:js_csharp"
      - "//examples/routeguide:js_go"
      - "//examples/routeguide:js_java"
      - "//examples/routeguide:js_js"
      - "//examples/routeguide:js_python"
      - "//examples/routeguide:python_cpp"
      - "//examples/routeguide:python_csharp"
      - "//examples/routeguide:python_go"
      - "//examples/routeguide:python_java"
      - "//examples/routeguide:python_js"
      - "//examples/routeguide:python_python"

  main_windows_arm64:
    name: Build & Test All
    platform: windows_arm64
    test_flags:
      - "--test_output=errors"
      - "--enable_runfiles"
      - "--cxxopt=/std:c++17"
      - "--host_cxxopt=/std:c++17"
      - "--define=protobuf_allow_msvc=true"
    test_targets:
      - "//examples/routeguide:cpp_cpp"
      - "//examples/routeguide:cpp_csharp"
      - "//examples/routeguide:cpp_go"
      - "//examples/routeguide:cpp_java"
      - "//examples/routeguide:cpp_js"
      - "//examples/routeguide:cpp_python"
      - "//examples/routeguide:csharp_cpp"
      - "//examples/routeguide:csharp_csharp"
      - "//examples/routeguide:csharp_go"
      - "//examples/routeguide:csharp_java"
      - "//examples/routeguide:csharp_js"
      - "//examples/routeguide:csharp_python"
      - "//examples/routeguide:go_cpp"
      - "//examples/routeguide:go_csharp"
      - "//examples/routeguide:go_go"
      - "//examples/routeguide:go_java"
      - "//examples/routeguide:go_js"
      - "//examples/routeguide:go_python"
      - "//examples/routeguide:java_cpp"
      - "//examples/routeguide:java_csharp"
      - "//examples/routeguide:java_go"
      - "//examples/routeguide:java_java"
      - "//examples/routeguide:java_js"
      - "//examples/routeguide:java_python"
      - "//examples/routeguide:js_cpp"
      - "//examples/routeguide:js_csharp"
      - "//examples/routeguide:js_go"
      - "//examples/routeguide:js_java"
      - "//examples/routeguide:js_js"
      - "//examples/routeguide:js_python"
      - "//examples/routeguide:python_cpp"
      - "//examples/routeguide:python_csharp"
      - "//examples/routeguide:python_go"
      - "//examples/routeguide:python_java"
      - "//examples/routeguide:python_js"
      - "//examples/routeguide:python_python"

  main_macos:
    name: Build & Test All
    platform: macos
    test_flags:
      - "--test_output=errors"
      - "--cxxopt=-std=c++17"
      - "--host_cxxopt=-std=c++17"
    test_targets:
      - "//examples/routeguide:cpp_cpp"
      - "//examples/routeguide:cpp_csharp"
      - "//examples/routeguide:cpp_go"
      - "//examples/routeguide:cpp_java"
      - "//examples/routeguide:cpp_js"
      - "//examples/routeguide:cpp_python"
      - "//examples/routeguide:csharp_cpp"
      - "//examples/routeguide:csharp_csharp"
      - "//examples/routeguide:csharp_go"
      - "//examples/routeguide:csharp_java"
      - "//examples/routeguide:csharp_js"
      - "//examples/routeguide:csharp_python"
      - "//examples/routeguide:go_cpp"
      - "//examples/routeguide:go_csharp"
      - "//examples/routeguide:go_go"
      - "//examples/routeguide:go_java"
      - "//examples/routeguide:go_js"
      - "//examples/routeguide:go_python"
      - "//examples/routeguide:java_cpp"
      - "//examples/routeguide:java_csharp"
      - "//examples/routeguide:java_go"
      - "//examples/routeguide:java_java"
      - "//examples/routeguide:java_js"
      - "//examples/routeguide:java_python"
      - "//examples/routeguide:js_cpp"
      - "//examples/routeguide:js_csharp"
      - "//examples/routeguide:js_go"
      - "//examples/routeguide:js_java"
      - "//examples/routeguide:js_js"
      - "//examples/routeguide:js_python"
      - "//examples/routeguide:python_cpp"
      - "//examples/routeguide:python_csharp"
      - "//examples/routeguide:python_go"
      - "//examples/routeguide:python_java"
      - "//examples/routeguide:python_js"
      - "//examples/routeguide:python_python"
      - "//examples/routeguide:scala_cpp"
      - "//examples/routeguide:scala_csharp"
      - "//examples/routeguide:scala_go"
      - "//examples/routeguide:scala_java"
      - "//examples/routeguide:scala_js"
      - "//examples/routeguide:scala_python"

  main_macos_arm64:
    name: Build & Test All
    platform: macos_arm64
    test_flags:
      - "--test_output=errors"
      - "--cxxopt=-std=c++17"
      - "--host_cxxopt=-std=c++17"
    test_targets:
      - "//examples/routeguide:cpp_cpp"
      - "//examples/routeguide:cpp_csharp"
      - "//examples/routeguide:cpp_go"
      - "//examples/routeguide:cpp_python"
      - "//examples/routeguide:csharp_cpp"
      - "//examples/routeguide:csharp_csharp"
      - "//examples/routeguide:csharp_go"
      - "//examples/routeguide:csharp_python"
      - "//examples/routeguide:go_cpp"
      - "//examples/routeguide:go_csharp"
      - "//examples/routeguide:go_go"
      - "//examples/routeguide:go_python"
      - "//examples/routeguide:python_cpp"
      - "//examples/routeguide:python_csharp"
      - "//examples/routeguide:python_go"
      - "//examples/routeguide:python_python"
      - "//examples/routeguide:scala_cpp"
      - "//examples/routeguide:scala_csharp"
      - "//examples/routeguide:scala_go"
      - "//examples/routeguide:scala_python"

  buf_ubuntu2204_examples:
    name: Buf
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make buf_buf_proto_breaking_test_example
      - make buf_buf_proto_lint_test_example

  buf_windows_examples:
    name: Buf
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo buf_proto_breaking_test
      - cd examples/buf/buf_proto_breaking_test
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo buf_proto_lint_test
      - cd examples/buf/buf_proto_lint_test
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  buf_windows_arm64_examples:
    name: Buf
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo buf_proto_breaking_test
      - cd examples/buf/buf_proto_breaking_test
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo buf_proto_lint_test
      - cd examples/buf/buf_proto_lint_test
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  buf_macos_examples:
    name: Buf
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make buf_buf_proto_breaking_test_example
      - make buf_buf_proto_lint_test_example

  buf_macos_arm64_examples:
    name: Buf
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make buf_buf_proto_breaking_test_example
      - make buf_buf_proto_lint_test_example

  cpp_ubuntu2204_examples:
    name: C++
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make cpp_cpp_proto_compile_example
      - make cpp_cpp_grpc_compile_example
      - make cpp_cpp_proto_library_example
      - make cpp_cpp_grpc_library_example

  cpp_windows_examples:
    name: C++
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo cpp_proto_compile
      - cd examples/cpp/cpp_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_grpc_compile
      - cd examples/cpp/cpp_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_proto_library
      - cd examples/cpp/cpp_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_grpc_library
      - cd examples/cpp/cpp_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  cpp_windows_arm64_examples:
    name: C++
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo cpp_proto_compile
      - cd examples/cpp/cpp_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_grpc_compile
      - cd examples/cpp/cpp_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_proto_library
      - cd examples/cpp/cpp_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo cpp_grpc_library
      - cd examples/cpp/cpp_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  cpp_macos_examples:
    name: C++
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make cpp_cpp_proto_compile_example
      - make cpp_cpp_grpc_compile_example
      - make cpp_cpp_proto_library_example
      - make cpp_cpp_grpc_library_example

  cpp_macos_arm64_examples:
    name: C++
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make cpp_cpp_proto_compile_example
      - make cpp_cpp_grpc_compile_example
      - make cpp_cpp_proto_library_example
      - make cpp_cpp_grpc_library_example

  csharp_ubuntu2204_examples:
    name: C#
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make csharp_csharp_proto_compile_example
      - make csharp_csharp_grpc_compile_example
      - make csharp_csharp_proto_library_example
      - make csharp_csharp_grpc_library_example

  csharp_windows_examples:
    name: C#
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo csharp_proto_compile
      - cd examples/csharp/csharp_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_grpc_compile
      - cd examples/csharp/csharp_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_proto_library
      - cd examples/csharp/csharp_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_grpc_library
      - cd examples/csharp/csharp_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  csharp_windows_arm64_examples:
    name: C#
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo csharp_proto_compile
      - cd examples/csharp/csharp_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_grpc_compile
      - cd examples/csharp/csharp_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_proto_library
      - cd examples/csharp/csharp_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo csharp_grpc_library
      - cd examples/csharp/csharp_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  csharp_macos_examples:
    name: C#
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make csharp_csharp_proto_compile_example
      - make csharp_csharp_grpc_compile_example
      - make csharp_csharp_proto_library_example
      - make csharp_csharp_grpc_library_example

  csharp_macos_arm64_examples:
    name: C#
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make csharp_csharp_proto_compile_example
      - make csharp_csharp_grpc_compile_example
      - make csharp_csharp_proto_library_example
      - make csharp_csharp_grpc_library_example

  doc_ubuntu2204_examples:
    name: Documentation
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make doc_doc_docbook_compile_example
      - make doc_doc_html_compile_example
      - make doc_doc_json_compile_example
      - make doc_doc_markdown_compile_example
      - make doc_doc_template_compile_example

  doc_windows_examples:
    name: Documentation
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo doc_docbook_compile
      - cd examples/doc/doc_docbook_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_html_compile
      - cd examples/doc/doc_html_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_json_compile
      - cd examples/doc/doc_json_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_markdown_compile
      - cd examples/doc/doc_markdown_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_template_compile
      - cd examples/doc/doc_template_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  doc_windows_arm64_examples:
    name: Documentation
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo doc_docbook_compile
      - cd examples/doc/doc_docbook_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_html_compile
      - cd examples/doc/doc_html_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_json_compile
      - cd examples/doc/doc_json_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_markdown_compile
      - cd examples/doc/doc_markdown_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo doc_template_compile
      - cd examples/doc/doc_template_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  doc_macos_examples:
    name: Documentation
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make doc_doc_docbook_compile_example
      - make doc_doc_html_compile_example
      - make doc_doc_json_compile_example
      - make doc_doc_markdown_compile_example
      - make doc_doc_template_compile_example

  doc_macos_arm64_examples:
    name: Documentation
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make doc_doc_docbook_compile_example
      - make doc_doc_html_compile_example
      - make doc_doc_json_compile_example
      - make doc_doc_markdown_compile_example
      - make doc_doc_template_compile_example

  go_ubuntu2204_examples:
    name: Go
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make go_go_proto_compile_example
      - make go_go_grpc_compile_example
      - make go_go_proto_library_example
      - make go_go_grpc_library_example

  go_windows_examples:
    name: Go
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo go_proto_compile
      - cd examples/go/go_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_grpc_compile
      - cd examples/go/go_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_proto_library
      - cd examples/go/go_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_grpc_library
      - cd examples/go/go_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  go_windows_arm64_examples:
    name: Go
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo go_proto_compile
      - cd examples/go/go_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_grpc_compile
      - cd examples/go/go_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_proto_library
      - cd examples/go/go_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo go_grpc_library
      - cd examples/go/go_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  go_macos_examples:
    name: Go
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make go_go_proto_compile_example
      - make go_go_grpc_compile_example
      - make go_go_proto_library_example
      - make go_go_grpc_library_example

  go_macos_arm64_examples:
    name: Go
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make go_go_proto_compile_example
      - make go_go_grpc_compile_example
      - make go_go_proto_library_example
      - make go_go_grpc_library_example

  grpc_gateway_ubuntu2204_examples:
    name: gRPC-Gateway
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make grpc_gateway_gateway_grpc_compile_example
      - make grpc_gateway_gateway_openapiv2_compile_example
      - make grpc_gateway_gateway_openapiv2_combined_compile_example
      - make grpc_gateway_gateway_grpc_library_example

  grpc_gateway_windows_examples:
    name: gRPC-Gateway
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo gateway_grpc_compile
      - cd examples/grpc_gateway/gateway_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_openapiv2_compile
      - cd examples/grpc_gateway/gateway_openapiv2_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_openapiv2_combined_compile
      - cd examples/grpc_gateway/gateway_openapiv2_combined_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_grpc_library
      - cd examples/grpc_gateway/gateway_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  grpc_gateway_windows_arm64_examples:
    name: gRPC-Gateway
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo gateway_grpc_compile
      - cd examples/grpc_gateway/gateway_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_openapiv2_compile
      - cd examples/grpc_gateway/gateway_openapiv2_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_openapiv2_combined_compile
      - cd examples/grpc_gateway/gateway_openapiv2_combined_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo gateway_grpc_library
      - cd examples/grpc_gateway/gateway_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  grpc_gateway_macos_examples:
    name: gRPC-Gateway
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make grpc_gateway_gateway_grpc_compile_example
      - make grpc_gateway_gateway_openapiv2_compile_example
      - make grpc_gateway_gateway_openapiv2_combined_compile_example
      - make grpc_gateway_gateway_grpc_library_example

  grpc_gateway_macos_arm64_examples:
    name: gRPC-Gateway
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make grpc_gateway_gateway_grpc_compile_example
      - make grpc_gateway_gateway_openapiv2_compile_example
      - make grpc_gateway_gateway_openapiv2_combined_compile_example
      - make grpc_gateway_gateway_grpc_library_example

  java_ubuntu2204_examples:
    name: Java
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make java_java_proto_compile_example
      - make java_java_grpc_compile_example
      - make java_java_proto_library_example
      - make java_java_grpc_library_example

  java_windows_examples:
    name: Java
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo java_proto_compile
      - cd examples/java/java_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_grpc_compile
      - cd examples/java/java_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_proto_library
      - cd examples/java/java_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_grpc_library
      - cd examples/java/java_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  java_windows_arm64_examples:
    name: Java
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo java_proto_compile
      - cd examples/java/java_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_grpc_compile
      - cd examples/java/java_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_proto_library
      - cd examples/java/java_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo java_grpc_library
      - cd examples/java/java_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  java_macos_examples:
    name: Java
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make java_java_proto_compile_example
      - make java_java_grpc_compile_example
      - make java_java_proto_library_example
      - make java_java_grpc_library_example

  java_macos_arm64_examples:
    name: Java
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make java_java_proto_compile_example
      - make java_java_proto_library_example

  js_ubuntu2204_examples:
    name: JavaScript
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make js_js_proto_compile_example
      - make js_js_grpc_compile_example
      - make js_js_grpc_web_compile_example
      - make js_js_proto_library_example
      - make js_js_grpc_library_example
      - make js_js_grpc_web_library_example

  js_windows_examples:
    name: JavaScript
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo js_proto_compile
      - cd examples/js/js_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_compile
      - cd examples/js/js_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_web_compile
      - cd examples/js/js_grpc_web_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_proto_library
      - cd examples/js/js_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_library
      - cd examples/js/js_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_web_library
      - cd examples/js/js_grpc_web_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  js_windows_arm64_examples:
    name: JavaScript
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo js_proto_compile
      - cd examples/js/js_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_compile
      - cd examples/js/js_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_web_compile
      - cd examples/js/js_grpc_web_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_proto_library
      - cd examples/js/js_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_library
      - cd examples/js/js_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo js_grpc_web_library
      - cd examples/js/js_grpc_web_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  js_macos_examples:
    name: JavaScript
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make js_js_proto_compile_example
      - make js_js_grpc_compile_example
      - make js_js_grpc_web_compile_example
      - make js_js_proto_library_example
      - make js_js_grpc_library_example
      - make js_js_grpc_web_library_example

  python_ubuntu2204_examples:
    name: Python
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make python_python_proto_compile_example
      - make python_python_grpc_compile_example
      - make python_python_grpclib_compile_example
      - make python_python_proto_library_example
      - make python_python_grpc_library_example
      - make python_python_grpclib_library_example

  python_windows_examples:
    name: Python
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo python_proto_compile
      - cd examples/python/python_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpc_compile
      - cd examples/python/python_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpclib_compile
      - cd examples/python/python_grpclib_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_proto_library
      - cd examples/python/python_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpc_library
      - cd examples/python/python_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpclib_library
      - cd examples/python/python_grpclib_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  python_windows_arm64_examples:
    name: Python
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo python_proto_compile
      - cd examples/python/python_proto_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpc_compile
      - cd examples/python/python_grpc_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpclib_compile
      - cd examples/python/python_grpclib_compile
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_proto_library
      - cd examples/python/python_proto_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpc_library
      - cd examples/python/python_grpc_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..
      - echo python_grpclib_library
      - cd examples/python/python_grpclib_library
      - bazel --batch build %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --disk_cache=../../bazel-disk-cache //... || exit 1
      - cd ../../..

  python_macos_examples:
    name: Python
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make python_python_proto_compile_example
      - make python_python_grpc_compile_example
      - make python_python_grpclib_compile_example
      - make python_python_proto_library_example
      - make python_python_grpc_library_example
      - make python_python_grpclib_library_example

  python_macos_arm64_examples:
    name: Python
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make python_python_proto_compile_example
      - make python_python_grpc_compile_example
      - make python_python_grpclib_compile_example
      - make python_python_proto_library_example
      - make python_python_grpc_library_example
      - make python_python_grpclib_library_example

  scala_ubuntu2204_examples:
    name: Scala
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make scala_scala_proto_compile_example
      - make scala_scala_grpc_compile_example
      - make scala_scala_proto_library_example
      - make scala_scala_grpc_library_example

  scala_macos_examples:
    name: Scala
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make scala_scala_proto_compile_example
      - make scala_scala_grpc_compile_example
      - make scala_scala_proto_library_example
      - make scala_scala_grpc_library_example

  scala_macos_arm64_examples:
    name: Scala
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make scala_scala_proto_compile_example
      - make scala_scala_grpc_compile_example
      - make scala_scala_proto_library_example
      - make scala_scala_grpc_library_example

  swift_macos_examples:
    name: Swift
    platform: macos
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
      CC: clang
    shell_commands:
      - set -x
      - make swift_swift_proto_compile_example
      - make swift_swift_grpc_compile_example
      - make swift_swift_proto_library_example
      - make swift_swift_grpc_library_example

  swift_macos_arm64_examples:
    name: Swift
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
      CC: clang
    shell_commands:
      - set -x
      - make swift_swift_proto_compile_example
      - make swift_swift_grpc_compile_example
      - make swift_swift_proto_library_example
      - make swift_swift_grpc_library_example

  ubuntu2204_test_workspaces:
    name: Test Workspaces
    platform: ubuntu2204
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make test_workspace_absolute_strip_import_prefix
      - make test_workspace_combined_strip_and_add_prefix
      - make test_workspace_common_cpp_library
      - make test_workspace_empty_output_directory
      - make test_workspace_exclusions
      - make test_workspace_generated_proto
      - make test_workspace_go_fixer
      - make test_workspace_go_importpath
      - make test_workspace_import_prefix
      - make test_workspace_java_deps
      - make test_workspace_nested_output_directory
      - make test_workspace_objc_capitalisation
      - make test_workspace_prefix_path
      - make test_workspace_python3_grpc
      - make test_workspace_python_dashes
      - make test_workspace_python_deps
      - make test_workspace_python_dots
      - make test_workspace_relative_strip_import_prefix
      - make test_workspace_shared_proto
      - make test_workspace_special_characters

  windows_test_workspaces:
    name: Test Workspaces
    platform: windows
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo absolute_strip_import_prefix
      - cd test_workspaces/absolute_strip_import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo combined_strip_and_add_prefix
      - cd test_workspaces/combined_strip_and_add_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo common_cpp_library
      - cd test_workspaces/common_cpp_library
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo empty_output_directory
      - cd test_workspaces/empty_output_directory
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo exclusions
      - cd test_workspaces/exclusions
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo generated_proto
      - cd test_workspaces/generated_proto
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo go_fixer
      - cd test_workspaces/go_fixer
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo go_importpath
      - cd test_workspaces/go_importpath
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo import_prefix
      - cd test_workspaces/import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo java_deps
      - cd test_workspaces/java_deps
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo nested_output_directory
      - cd test_workspaces/nested_output_directory
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo objc_capitalisation
      - cd test_workspaces/objc_capitalisation
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo prefix_path
      - cd test_workspaces/prefix_path
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python3_grpc
      - cd test_workspaces/python3_grpc
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_dashes
      - cd test_workspaces/python_dashes
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_deps
      - cd test_workspaces/python_deps
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_dots
      - cd test_workspaces/python_dots
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo relative_strip_import_prefix
      - cd test_workspaces/relative_strip_import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo shared_proto
      - cd test_workspaces/shared_proto
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo special_characters
      - cd test_workspaces/special_characters
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..

  windows_arm64_test_workspaces:
    name: Test Workspaces
    platform: windows_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=/std:c++17 --host_cxxopt=/std:c++17 --define=protobuf_allow_msvc=true"
    batch_commands:
      - echo absolute_strip_import_prefix
      - cd test_workspaces/absolute_strip_import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo combined_strip_and_add_prefix
      - cd test_workspaces/combined_strip_and_add_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo common_cpp_library
      - cd test_workspaces/common_cpp_library
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo empty_output_directory
      - cd test_workspaces/empty_output_directory
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo exclusions
      - cd test_workspaces/exclusions
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo generated_proto
      - cd test_workspaces/generated_proto
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo go_fixer
      - cd test_workspaces/go_fixer
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo go_importpath
      - cd test_workspaces/go_importpath
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo import_prefix
      - cd test_workspaces/import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo java_deps
      - cd test_workspaces/java_deps
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo nested_output_directory
      - cd test_workspaces/nested_output_directory
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo objc_capitalisation
      - cd test_workspaces/objc_capitalisation
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo prefix_path
      - cd test_workspaces/prefix_path
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python3_grpc
      - cd test_workspaces/python3_grpc
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_dashes
      - cd test_workspaces/python_dashes
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_deps
      - cd test_workspaces/python_deps
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo python_dots
      - cd test_workspaces/python_dots
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo relative_strip_import_prefix
      - cd test_workspaces/relative_strip_import_prefix
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo shared_proto
      - cd test_workspaces/shared_proto
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..
      - echo special_characters
      - cd test_workspaces/special_characters
      - bazel --batch test %BAZEL_EXTRA_FLAGS% --enable_runfiles --verbose_failures --test_output=errors --disk_cache=../bazel-disk-cache //... || exit 1
      - cd ../..

  macos_arm64_test_workspaces:
    name: Test Workspaces
    platform: macos_arm64
    environment:
      BAZEL_EXTRA_FLAGS: "--cxxopt=-std=c++17 --host_cxxopt=-std=c++17"
    shell_commands:
      - set -x
      - make test_workspace_absolute_strip_import_prefix
      - make test_workspace_combined_strip_and_add_prefix
      - make test_workspace_common_cpp_library
      - make test_workspace_empty_output_directory
      - make test_workspace_exclusions
      - make test_workspace_generated_proto
      - make test_workspace_go_fixer
      - make test_workspace_go_importpath
      - make test_workspace_import_prefix
      - make test_workspace_java_deps
      - make test_workspace_nested_output_directory
      - make test_workspace_objc_capitalisation
      - make test_workspace_prefix_path
      - make test_workspace_python3_grpc
      - make test_workspace_python_dashes
      - make test_workspace_python_deps
      - make test_workspace_python_dots
      - make test_workspace_relative_strip_import_prefix
      - make test_workspace_shared_proto
      - make test_workspace_special_characters
